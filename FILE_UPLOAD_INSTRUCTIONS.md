# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

## üéØ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **MessagesController** (`app/controllers/messages_controller.rb`)
```ruby
def message_params
  params.require(:message).permit(:content, files: [])
end
```
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–∏–≤–∞ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö

### 2. **–§–æ—Ä–º–∞ —á–∞—Ç–∞** (`app/views/chats/show.html.erb`)
```erb
<%= file_field_tag 'message[files][]', 
  multiple: true,
  accept: "image/*,application/pdf,.txt,.doc,.docx,.csv,.json",
  ... %>
```
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–º—è –ø–æ–ª—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ–∞–π–ª–æ–≤

### 3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π** (`app/views/messages/_message.html.erb`)
- ‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –ø—Ä–µ–≤—å—é
- ‚úÖ –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (.txt, .json) —Å –∏–∫–æ–Ω–∫–æ–π –∏ –ø—Ä–µ–≤—å—é —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ AI** (`app/jobs/chat_response_job.rb`)
```ruby
def process_attached_files(message)
  # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è ‚Üí base64 –¥–ª—è vision AI
  # –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã ‚Üí –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ –ø—Ä–æ–º–ø—Ç
end
```
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ base64 –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ AI –∫–∞–∫ vision input
- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã**: —á–∏—Ç–∞—é—Ç—Å—è –∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è AI

## üìÅ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

### –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å AI Vision)
- ‚úÖ JPG, JPEG
- ‚úÖ PNG
- ‚úÖ GIF
- ‚úÖ WebP
- ‚úÖ –õ—é–±—ã–µ image/* —Ñ–æ—Ä–º–∞—Ç—ã

### –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (AI —á–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ)
- ‚úÖ .txt (—Å –ø—Ä–µ–≤—å—é –ø–µ—Ä–≤—ã—Ö 500 —Å–∏–º–≤–æ–ª–æ–≤)
- ‚úÖ .json (—Å –ø—Ä–µ–≤—å—é)

### –î–æ–∫—É–º–µ–Ω—Ç—ã (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ)
- ‚úÖ .pdf
- ‚úÖ .doc, .docx
- ‚úÖ .csv

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. **–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª**: 
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É üìé –≤ —Ñ–æ—Ä–º–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
   - –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤

2. **–ü—Ä–µ–≤—å—é —Ñ–∞–π–ª–æ–≤**:
   - –í—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ—è–≤—è—Ç—Å—è –≤ –ø—Ä–µ–≤—å—é
   - –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –∫–Ω–æ–ø–∫–æ–π ‚úï

3. **–û—Ç–ø—Ä–∞–≤–∏—Ç—å**:
   - –ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   - –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚úàÔ∏è

4. **AI –∞–Ω–∞–ª–∏–∑**:
   - **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: AI –º–æ–∂–µ—Ç –∏—Ö "–≤–∏–¥–µ—Ç—å" –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
   - **–¢–µ–∫—Å—Ç**: AI —á–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∏ –º–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ –Ω–µ–º

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –•—Ä–∞–Ω–∏–ª–∏—â–µ
- –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ **ActiveStorage**
- –ú–æ–¥–µ–ª—å Message: `has_many_attached :files`

### –ü–µ—Ä–µ–¥–∞—á–∞ –≤ AI
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: `data:image/jpeg;base64,/9j/4AAQ...`
- **–¢–µ–∫—Å—Ç**: –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø—Ä–æ–º–ø—Ç –∫–∞–∫:
  ```
  –ü–†–ò–ö–†–ï–ü–õ–ï–ù–ù–´–ô –§–ê–ô–õ: example.txt
  ```
  [—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞]
  ```
  ```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (accept)
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤ –º–æ–¥–µ–ª–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤

## üì± –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- Touch-friendly –∫–Ω–æ–ø–∫–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ–≤—å—é
- –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏
- Responsive –¥–∏–∑–∞–π–Ω

## üêõ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

–ï—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–æ—Ä–º–∞ –∏–º–µ–µ—Ç `multipart: true`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ActiveStorage –Ω–∞—Å—Ç—Ä–æ–µ–Ω (`rails active_storage:install`)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏: `rails db:migrate`

## üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [üì∑ image.jpg] –ß—Ç–æ –Ω–∞ —ç—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–µ?
AI: –ù–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —è –≤–∏–∂—É...
```

### –ß—Ç–µ–Ω–∏–µ –∫–æ–¥–∞
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [üìÑ script.txt] –û–±—ä—è—Å–Ω–∏ —ç—Ç–æ—Ç –∫–æ–¥
AI: –≠—Ç–æ—Ç –∫–æ–¥ –¥–µ–ª–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–µ...
```

### –ù–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: [üì∑ chart.png] [üìÑ data.csv] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ
AI: –°—É–¥—è –ø–æ –≥—Ä–∞—Ñ–∏–∫—É –∏ –¥–∞–Ω–Ω—ã–º...
```

---

**–ì–æ—Ç–æ–≤–æ! –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ! üéâ**
